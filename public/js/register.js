(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{"3OJL":function(e,t,r){"use strict";r.r(t);var n=r("o0o1"),o=r.n(n),i=r("fpkf"),a=r("4HBT"),s=r.n(a),c=r("C3Ci"),u=r("Fl2b"),l=r("4JY7");function d(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}var f,p,h={middleware:"guest",components:{OAuth:u.a,VueRecaptcha:l.a},mixins:[c.a],metaInfo:function(){return{title:this.$t("Registration")}},data:function(){return{showPassword:!1,showPassword2:!1,form:new s.a({name:null,email:null,password:null,password_confirmation:null,recaptcha:null})}},computed:{appLogoUrl:function(){return Object(i.a)("app.logo")},emailVerification:function(){return Object(i.a)("settings.email_verification")},recaptchaPublicKey:function(){return Object(i.a)("services.recaptcha.public_key")}},methods:{register:(f=o.a.mark((function e(){var t,r,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.form.post("/api/auth/register").catch((function(){return n.recaptchaPublicKey&&(n.form.recaptcha=null,n.$refs.recaptcha.reset()),{}}));case 2:t=e.sent,(r=t.data)&&(this.$store.dispatch("auth/updateUser",r),this.$store.dispatch("message/success",{text:this.emailVerification?["We have sent a verification link to your email.","Please click on that link to verify your email and continue using our website."].map((function(e){return n.$t(e)})).join(" "):this.$t("You have successfully registered!")}),this.$router.push({name:"home"}));case 5:case"end":return e.stop()}}),e,this)})),p=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=f.apply(e,t);function i(e){d(o,r,n,i,a,"next",e)}function a(e){d(o,r,n,i,a,"throw",e)}i(void 0)}))},function(){return p.apply(this,arguments)})}},m=r("KHd+"),w=r("ZUTo"),v=r.n(w),y=r("ghKu"),g=r("gzZi"),b=r("sK+t"),_=r("mdmw"),x=r("Yq0q"),k=r("pSOK"),$=r("S9TP"),O=r("rdoz"),P=r("D9m0"),j=r("L6Q5"),V=r("hlRy"),S=r("cdmR"),C=r("Kn9U"),R=Object(m.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[r("v-row",{attrs:{align:"center",justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{color:"primary"}},[r("router-link",{attrs:{to:{name:"home"}}},[r("v-avatar",{attrs:{size:"40",tile:""}},[r("v-img",{attrs:{src:e.appLogoUrl}})],1)],1),e._v(" "),r("v-toolbar-title",{staticClass:"ml-2"},[e._v("\n            "+e._s(e.$t("Registration"))+"\n          ")]),e._v(" "),r("v-spacer")],1),e._v(" "),r("v-card-text",[r("o-auth"),e._v(" "),r("v-form",{ref:"form",on:{submit:function(t){return t.preventDefault(),e.register(t)}},model:{value:e.formIsValid,callback:function(t){e.formIsValid=t},expression:"formIsValid"}},[r("v-text-field",{attrs:{label:e.$t("Name"),type:"text",name:"name",rules:[e.validationRequired],error:e.form.errors.has("name"),"error-messages":e.form.errors.get("name"),outlined:""},on:{keydown:function(t){return e.clearFormErrors(t,"name")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v(" "),r("v-text-field",{attrs:{label:e.$t("Email"),type:"email",name:"email",rules:[e.validationRequired,e.validationEmail],error:e.form.errors.has("email"),"error-messages":e.form.errors.get("email"),outlined:""},on:{keydown:function(t){return e.clearFormErrors(t,"email")}},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),e._v(" "),r("v-text-field",{attrs:{label:e.$t("Password"),"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",name:"password",rules:[e.validationRequired,function(t){return e.validationMinLength(t,6)}],error:e.form.errors.has("password"),"error-messages":e.form.errors.get("password"),outlined:"",counter:""},on:{"click:append":function(t){e.showPassword=!e.showPassword},keydown:function(t){return e.clearFormErrors(t,"password")}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._v(" "),r("v-text-field",{attrs:{label:e.$t("Confirm password"),"append-icon":e.showPassword2?"mdi-eye":"mdi-eye-off",type:e.showPassword2?"text":"password",name:"password_confirmation",rules:[e.validationRequired,function(t){return e.validationMatch(e.form.password,t)}],error:e.form.errors.has("password_confirmation"),"error-messages":e.form.errors.get("password_confirmation"),outlined:"",counter:""},on:{"click:append":function(t){e.showPassword2=!e.showPassword2},keydown:function(t){return e.clearFormErrors(t,"password_confirmation")}},model:{value:e.form.password_confirmation,callback:function(t){e.$set(e.form,"password_confirmation",t)},expression:"form.password_confirmation"}}),e._v(" "),e.recaptchaPublicKey?r("vue-recaptcha",{ref:"recaptcha",staticClass:"mb-3",attrs:{sitekey:e.recaptchaPublicKey,loadRecaptchaScript:!0,theme:this.$vuetify.theme.isDark?"dark":"light"},on:{verify:function(t){return e.form.recaptcha=t}}}):e._e(),e._v(" "),r("v-row",{attrs:{align:"center"}},[r("v-col",{staticClass:"text-center text-md-left"},[r("v-btn",{attrs:{type:"submit",color:"primary",disabled:!e.formIsValid||e.form.busy||!!e.recaptchaPublicKey&&!e.form.recaptcha,loading:e.form.busy}},[e._v("\n                  "+e._s(e.$t("Register"))+"\n                ")])],1),e._v(" "),r("v-col",{staticClass:"text-center text-md-right"},[r("router-link",{attrs:{to:{name:"login"}}},[e._v("\n                  "+e._s(e.$t("Already signed up?"))+"\n                ")])],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=R.exports;v()(R,{VAvatar:y.a,VBtn:g.a,VCard:b.a,VCardText:_.c,VCol:x.a,VContainer:k.a,VForm:$.a,VImg:O.a,VRow:P.a,VSpacer:j.a,VTextField:V.a,VToolbar:S.a,VToolbarTitle:C.a})},"4JY7":function(e,t,r){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var o=function(){var e=!1,t=[];return{resolved:function(){return e},resolve:function(r){if(!e){e=!0;for(var n=0,o=t.length;n<o;n++)t[n](r)}},promise:{then:function(r){e?r():t.push(r)}}}},i=Object.prototype.hasOwnProperty;var a,s=(a=o(),{notify:function(){a.resolve()},wait:function(){return a.promise},render:function(e,t,r){this.wait().then((function(){r(window.grecaptcha.render(e,t))}))},reset:function(e){void 0!==e&&(this.assertLoaded(),this.wait().then((function(){return window.grecaptcha.reset(e)})))},execute:function(e){void 0!==e&&(this.assertLoaded(),this.wait().then((function(){return window.grecaptcha.execute(e)})))},checkRecaptchaLoad:function(){i.call(window,"grecaptcha")&&i.call(window.grecaptcha,"render")&&this.notify()},assertLoaded:function(){if(!a.resolved())throw new Error("ReCAPTCHA has not been loaded")}});"undefined"!=typeof window&&(window.vueRecaptchaApiLoaded=s.notify);var c={name:"VueRecaptcha",props:{sitekey:{type:String,required:!0},theme:{type:String},badge:{type:String},type:{type:String},size:{type:String},tabindex:{type:String},loadRecaptchaScript:{type:Boolean,default:!1},recaptchaScriptId:{type:String,default:"__RECAPTCHA_SCRIPT"},recaptchaHost:{type:String,default:"www.google.com"},language:{type:String,default:""}},beforeMount:function(){if(this.loadRecaptchaScript&&!document.getElementById(this.recaptchaScriptId)){var e=document.createElement("script");e.id=this.recaptchaScriptId,e.src="https://"+this.recaptchaHost+"/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit&hl="+this.language,e.async=!0,e.defer=!0,document.head.appendChild(e)}},mounted:function(){var e=this;s.checkRecaptchaLoad();var t=n({},this.$props,{callback:this.emitVerify,"expired-callback":this.emitExpired,"error-callback":this.emitError}),r=this.$slots.default?this.$el.children[0]:this.$el;s.render(r,t,(function(t){e.$widgetId=t,e.$emit("render",t)}))},methods:{reset:function(){s.reset(this.$widgetId)},execute:function(){s.execute(this.$widgetId)},emitVerify:function(e){this.$emit("verify",e)},emitExpired:function(){this.$emit("expired")},emitError:function(){this.$emit("error")}},render:function(e){return e("div",{},this.$slots.default)}};t.a=c},Fl2b:function(e,t,r){"use strict";var n,o,i=r("o0o1"),a=r.n(i),s=r("fpkf"),c=r("ZXch"),u=r("L2JU");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){d(i,n,o,a,s,"next",e)}function s(e){d(i,n,o,a,s,"throw",e)}a(void 0)}))}}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"===l(e)&&(r=e,e=""),r=h({url:e,title:t,width:600,height:720},r);var n=void 0!==window.screenLeft?window.screenLeft:window.screen.left,o=void 0!==window.screenTop?window.screenTop:window.screen.top,i=window.innerWidth||document.documentElement.clientWidth||window.screen.width,a=window.innerHeight||document.documentElement.clientHeight||window.screen.height;r.left=i/2-r.width/2+n,r.top=a/2-r.height/2+o;var s=Object.keys(r).reduce((function(e,t){return e.push("".concat(t,"=").concat(r[t])),e}),[]).join(","),c=window.open(e,t,s);return window.focus&&c.focus(),c}var v={name:"OAuth",computed:h({},Object(u.d)("auth",["user"]),{providers:function(){return Object(s.a)("oauth")},providersCount:function(){return this.providers?Object.keys(this.providers).length:0}}),mounted:function(){window.addEventListener("message",this.onMessage,!1)},beforeDestroy:function(){window.removeEventListener("message",this.onMessage)},methods:{ucfirst:c.n,loginWith:(o=f(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=w("",this.$t("Log in with {0}",[t])),e.next=3,this.$store.dispatch("auth/fetchOAuthRedirectUrl",{provider:t});case 3:r.location.href=e.sent;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)}),onMessage:(n=f(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.origin===window.origin&&t.data.user){e.next=2;break}return e.abrupt("return");case 2:this.$store.dispatch("auth/updateUser",t.data.user),this.user.two_factor_auth_enabled&&!this.user.two_factor_auth_passed?this.$router.push({name:"2fa"}):this.$router.push({name:"home"});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}},y=r("KHd+"),g=r("ZUTo"),b=r.n(g),_=r("gzZi"),x=r("Yq0q"),k=r("zn5u"),$=r("Ey0z"),O=r("D9m0"),P=r("Oi+f"),j=Object(y.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.providersCount?r("v-row",[r("v-col",{staticClass:"text-center"},[e._l(e.providers,(function(t,n){return r("v-btn",{key:n,staticClass:"mx-2",attrs:{fab:"",icon:"",elevation:"5"},on:{click:function(t){return e.loginWith(n)}}},[r("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(o){var i=o.on;return[r("v-icon",e._g({attrs:{large:""}},i),[e._v("\n            mdi-"+e._s(t.mdi||n)+"\n          ")])]}}],null,!0)},[e._v(" "),r("span",[e._v(e._s(e.$t("Log in with {0}",[e.ucfirst(n)])))])])],1)})),e._v(" "),r("v-divider",{staticClass:"my-7"})],2)],1):e._e()}),[],!1,null,null,null);t.a=j.exports;b()(j,{VBtn:_.a,VCol:x.a,VDivider:k.a,VIcon:$.a,VRow:O.a,VTooltip:P.a})}}]);
//# sourceMappingURL=register.js.map